<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Aavaaz - Voice Memory Companion</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',Tahoma,Geneva;background:#f5f5f5}.navbar{background:rgba(0,0,0,0.8);padding:15px 30px;display:flex;justify-content:space-between;align-items:center;color:white}.navbar h1{font-size:24px}.nav-links{display:flex;gap:20px;align-items:center}.nav-links a,.nav-links button{color:white;text-decoration:none;background:0;border:0;cursor:pointer;font-size:14px}.logout-btn{background:#ff4757;padding:8px 16px;border-radius:4px}.dashboard-page{display:none;padding:20px}.dashboard-page.active{display:grid;grid-template-columns:250px 1fr;gap:20px}.sidebar{background:white;border-radius:8px;padding:20px;box-shadow:0 2px 8px rgba(0,0,0,0.1)}.sidebar h3{margin-bottom:15px;color:#333}.sidebar a{display:block;padding:12px;margin-bottom:10px;background:#f0f0f0;border-radius:4px;cursor:pointer;color:#333;transition:all 0.3s}.sidebar a:hover{background:#667eea;color:white}.sidebar a.active{background:#667eea;color:white}.content-area{background:white;border-radius:8px;padding:30px;box-shadow:0 2px 8px rgba(0,0,0,0.1)}.content-section{display:none}.content-section.active{display:block}.section-title{font-size:28px;color:#333;margin-bottom:20px}.btn-record{background:#667eea;color:white;padding:15px 40px;border:0;border-radius:4px;cursor:pointer;margin-bottom:20px;font-weight:bold;transition:all 0.3s}.btn-record:hover{background:#5568d3}.btn-record.recording{background:#ff4757;animation:pulse 1s infinite}.btn-delete{background:#ff4757;color:white;padding:10px 20px;border:0;border-radius:4px;cursor:pointer;margin-left:10px;font-weight:bold}.btn-delete:hover{background:#ff3838}.btn-play{background:#4CAF50;color:white;padding:10px 20px;border:0;border-radius:4px;cursor:pointer;margin-left:10px;font-weight:bold}.btn-play:hover{background:#45a049}.voice-setup{background:#f0f7ff;padding:20px;border-radius:8px;margin-bottom:20px;border-left:4px solid #667eea}.voice-setup h3{margin-bottom:15px;color:#333}.voice-setup p{color:#666;margin-bottom:10px;font-size:14px}.input-group{margin-bottom:15px}.input-group label{display:block;margin-bottom:5px;font-weight:bold;color:#333}.input-group textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-family:inherit}.conversation-history{background:#fff9e6;padding:15px;border-radius:8px;margin-bottom:20px;min-height:150px;max-height:400px;overflow-y:auto;border:1px solid #ddd}.message{margin-bottom:15px;padding:10px;border-radius:6px}.message.user{background:#667eea;color:white;margin-left:20px}.message.grok{background:#e8f5e9;color:#333;margin-right:20px;border-left:4px solid #4CAF50}.recording-preview{background:#fff3cd;padding:15px;border-radius:8px;margin-bottom:20px;border-left:4px solid #ffc107;display:none}.recording-preview.show{display:block}.recording-preview h4{margin-bottom:10px;color:#333}.recording-buttons{display:flex;gap:10px;align-items:center}.voice-player{background:white;padding:10px;border-radius:4px;display:flex;align-items:center;gap:10px}.status-text{font-size:12px;color:#999;margin-top:5px}@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.7}}</style></head><body><div class="navbar"><h1>Aavaaz</h1><div class="nav-links"><a href="#">Home</a><a href="#">Privacy</a><button class="logout-btn" onclick="logout()">Logout</button></div></div><div class="dashboard-page" id="dashboardPage"><div class="sidebar"><h3>Navigation</h3><a class="nav-item active" onclick="switchSection('voice-conversation',this)">üé§ Voice Conversation</a><a class="nav-item" onclick="switchSection('recordings',this)">üìù My Recordings</a><a class="nav-item" onclick="switchSection('calendar',this)">üìÖ Calendar</a><a class="nav-item" onclick="switchSection('settings',this)">‚öôÔ∏è Settings</a></div><div class="content-area"><div class="content-section active" id="voice-conversation-section"><h2 class="section-title">Voice Memory Conversation</h2><div class="voice-setup"><h3>1. Setup Your Reference Voice</h3><p>Record a reference voice (could be your loved one or yourself)</p><button class="btn-record" id="refVoiceBtn" onclick="toggleReferenceRecording()">üéôÔ∏è Record Reference Voice</button><div id="refVoiceStatus" class="status-text"></div><div id="recordingPreview" class="recording-preview"><h4>üìã Your Recording</h4><div class="recording-buttons"><audio id="voicePreview" class="voice-player" controls style="flex:1"></audio><button class="btn-play" onclick="playRecording()">‚ñ∂Ô∏è Play</button><button class="btn-delete" onclick="deleteRecording()">üóëÔ∏è Delete</button><button class="btn-record" onclick="confirmRecording()" style="background:#4CAF50">‚úì Confirm</button></div></div></div><div class="voice-setup"><h3>2. Have a Conversation</h3><p>Speak naturally about your memories, and Grok will respond with emotional intelligence using the reference voice</p><div class="input-group"><label>What would you like to say?</label><textarea id="userInput" placeholder="Share your thoughts, memories, or feelings..." rows="3"></textarea></div><button class="btn-record" onclick="sendVoiceMessage()">üí¨ Send & Get Response</button></div><div class="conversation-history" id="conversationHistory"></div></div><div class="content-section" id="recordings-section"><h2 class="section-title">My Recordings</h2><div id="recordingsList"></div></div><div class="content-section" id="calendar-section"><h2 class="section-title">Calendar</h2></div><div class="content-section" id="settings-section"><h2 class="section-title">Settings</h2></div></div></div><script>let currentUser=null;let isRecording=false;let mediaRecorder=null;let audioChunks=[];let recordedAudioUrl=null;let referenceVoiceId=null;let tempRecording=false;function initApp(){const user=localStorage.getItem('currentUser')||'demo_user';currentUser=user;showDashboard();loadReferenceVoice();const email=prompt('Enter email to login:');if(email){localStorage.setItem('currentUser',email);location.reload()}}function logout(){localStorage.removeItem('currentUser');location.reload()}function showDashboard(){document.getElementById('dashboardPage').classList.add('active')}function switchSection(section,element){document.querySelectorAll('.content-section').forEach(s=>s.classList.remove('active'));document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));document.getElementById(section+'-section').classList.add('active');element.classList.add('active')}function toggleReferenceRecording(){const btn=document.getElementById('refVoiceBtn');const status=document.getElementById('refVoiceStatus');const preview=document.getElementById('recordingPreview');if(!isRecording){isRecording=true;btn.textContent='‚èπÔ∏è Stop Recording';btn.style.background='#ff4757';status.textContent='üî¥ Recording...';status.style.color='#ff4757';startRecording()}else{isRecording=false;btn.textContent='üéôÔ∏è Record Reference Voice';btn.style.background='#667eea';status.textContent='‚è≥ Processing...';stopRecording();setTimeout(()=>{if(recordedAudioUrl){preview.classList.add('show');document.getElementById('voicePreview').src=recordedAudioUrl;status.textContent='‚úì Recording saved! Play to verify, then confirm or delete.';status.style.color='#4CAF50';tempRecording=true}},300)}}function startRecording(){navigator.mediaDevices.getUserMedia({audio:true}).then(stream=>{mediaRecorder=new MediaRecorder(stream);audioChunks=[];mediaRecorder.ondataavailable=e=>audioChunks.push(e.data);mediaRecorder.start()}).catch(err=>{alert('Microphone access denied: '+err.message)})}function stopRecording(){if(mediaRecorder){mediaRecorder.stop();mediaRecorder.stream.getTracks().forEach(track=>track.stop())}}function playRecording(){const audio=document.getElementById('voicePreview');audio.play()}function deleteRecording(){const preview=document.getElementById('recordingPreview');const status=document.getElementById('refVoiceStatus');const btn=document.getElementById('refVoiceBtn');recordedAudioUrl=null;audioChunks=[];tempRecording=false;preview.classList.remove('show');btn.textContent='üéôÔ∏è Record Reference Voice';btn.style.background='#667eea';status.textContent='Recording deleted. Ready to record again.';status.style.color='#999'}function confirmRecording(){if(!recordedAudioUrl){alert('No recording to confirm');return}const preview=document.getElementById('recordingPreview');const status=document.getElementById('refVoiceStatus');const btn=document.getElementById('refVoiceBtn');localStorage.setItem('referenceVoice_'+currentUser,recordedAudioUrl);referenceVoiceId='savedVoice';tempRecording=false;preview.classList.remove('show');btn.textContent='üéôÔ∏è Record Reference Voice';btn.style.background='#667eea';status.textContent='‚úì Reference voice confirmed and saved! Ready to have conversations.';status.style.color='#4CAF50'}function loadReferenceVoice(){const saved=localStorage.getItem('referenceVoice_'+currentUser);if(saved){referenceVoiceId='savedVoice';document.getElementById('refVoiceStatus').textContent='‚úì Reference voice loaded'}}function sendVoiceMessage(){const userInput=document.getElementById('userInput').value;if(!userInput){alert('Please enter your message');return}if(!referenceVoiceId){alert('Please record and confirm a reference voice first');return}const historyDiv=document.getElementById('conversationHistory');const userMsg=document.createElement('div');userMsg.className='message user';userMsg.textContent='You: '+userInput;historyDiv.appendChild(userMsg);historyDiv.scrollTop=historyDiv.scrollHeight;document.getElementById('userInput').value='';const grokMsg=document.createElement('div');grokMsg.className='message grok';grokMsg.innerHTML='Grok: <em>Generating response...</em>';historyDiv.appendChild(grokMsg);fetch('/api/generate-story',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({user:currentUser,userInput:userInput,voiceId:referenceVoiceId})}).then(r=>r.json()).then(data=>{if(data.success){grokMsg.innerHTML='Grok: '+data.response;if(data.audio){const audio=new Audio(data.audio);audio.play().catch(e=>console.error('Playback error:',e))}else{grokMsg.innerHTML+='<br><small>(Audio generation skipped)</small>'}}else{grokMsg.innerHTML='Grok: Error - '+(data.error||'Unknown error')}historyDiv.scrollTop=historyDiv.scrollHeight}).catch(e=>{grokMsg.innerHTML='Grok: Error - '+e.message;historyDiv.scrollTop=historyDiv.scrollHeight})}document.addEventListener('DOMContentLoaded',()=>{if(!localStorage.getItem('currentUser')){initApp()}else{currentUser=localStorage.getItem('currentUser');showDashboard();loadReferenceVoice()}})</script></body></html>
